from sage.all import *

# Parameters defining the extension
P = Integer(18446744069414584321)
DEGREE = 6
POWER_PRIMITIVE_ELEMENT = 70

# Polynomials defining the extension tower
POLY1 = "x^2 + x + 2"
POLY2 = "x^3 - 2"


# Parameters defining the Cheetah elliptic curve and its prime subgroup.
# Constants with the "_DIRECT" suffix correspond to the same constant,
# seen in an isomorphic field K ≅ Fp6 constructed as a direct sextic extension
# over Fp, compared to the tower extension k6 ≅ Fp6.
CURVE_FULL_ORDER = Integer(
    39402006141350512473373051550956862238057064441100873236174256442647746257864746526345403204485899399908458245200514)
CURVE_PRIME_ORDER = Integer(
    5093816862660114796539905562432132980077157336184415603755393655945963633877)
CURVE_COFACTOR = Integer(7735261632624504790170485097520692373882)

CURVE_COEFF_A = 1
CURVE_COEFF_B = "(7120795117428676901*u + 3202005702586504883)*v^2 + (9076483086909401830*u + 9827394022143078069)*v + 4388043251658197428*u + 11803702928030745588"
CURVE_COEFF_B_DIRECT = "3276474056883293133*z6^5 + 5255085064551464989*z6^4 + 11723682358796875189*z6^3 + 9942326121594854785*z6^2 + 15041390363505506718*z6 + 6204180223593521639"

CURVE_GENERATOR_X = "(255166192153906972*u + 14062060630764968556)*v^2 + (5087871832552696213*u + 9741981525975450940)*v + 16738295810734703473*u + 10748286653440627364"
CURVE_GENERATOR_Y = "(3258894927061932081*u + 3949619369322475213)*v^2 + (9166686081290733411*u + 14255354997242019920)*v + 6857523018799664721*u + 12860222650676387569"
CURVE_GENERATOR_X_DIRECT = "5246670032724717623*z6^5 + 3992288700255868789*z6^4 + 3233847998409001569*z6^3 + 5714825593344238481*z6^2 + 2490251640897216364*z6 + 14677566008529455844"
CURVE_GENERATOR_Y_DIRECT = "1306012239707335569*z6^5 + 12922475499671946398*z6^4 + 2176066290494298556*z6^3 + 8398057151970756846*z6^2 + 18133916187643209951*z6 + 7652502609019956449"

TWIST_PRIME_ORDER = Integer(
    41634373106591692444157580881625733476778895819484091455258638459)


# Helper constants for speeding-up embedding degree calculations
CURVE_PRIME_ORDER_MINUS_ONE_FACTORS = [(2, 2),
                                       (421, 1),
                                       (5253757, 1),
                                       (1495681430750334407, 1),
                                       (384939214828444177205162227587939758669175537011, 1)]

TWIST_PRIME_ORDER_MINUS_ONE_FACTORS = [(2, 1),
                                       (239, 1),
                                       (439, 1),
                                       (18341, 1),
                                       (50393304151, 1),
                                       (214666248831165428496357199473835305401660039, 1)]
